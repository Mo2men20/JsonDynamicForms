<div class="row">
    <div class="col-lg-12">
        <mat-checkbox class="example-margin" [(ngModel)]="controlData.fetchFromAPI">Fetch from an API</mat-checkbox>
    </div>
</div>
<ng-container *ngIf='controlData.fetchFromAPI'>
    <form [formGroup]='controlData.fetchForm'>
        <mat-form-field>
            <mat-label>API end</mat-label>
            <input matInput placeholder="Placeholder" formControlName='api'>
            <mat-error *ngIf="controlData.fetchForm.controls.api.errors">
                This field is <strong>required</strong>
            </mat-error>
        </mat-form-field>
        <mat-form-field>
            <mat-label>Argument name</mat-label>
            <input matInput placeholder="Placeholder" formControlName='arguments'>
            <mat-error *ngIf="controlData.fetchForm.controls.arguments.errors">
                This field is <strong>required</strong>
            </mat-error>
        </mat-form-field>
        <mat-form-field>
            <mat-label>Mapper function body</mat-label>
            <textarea matInput formControlName='body' rows='4'></textarea>
            <mat-error *ngIf="controlData.fetchForm.controls.body.errors">
                This field is <strong>required</strong>
            </mat-error>
        </mat-form-field>
    </form>
</ng-container>
<mat-list *ngIf='!controlData.fetchFromAPI'>
    <div mat-subheader>Options
        <button mat-icon-button type="button" (click)='addANewOption()'>
            <mat-icon>add</mat-icon>
        </button>
    </div>
    <ng-container *ngFor='let form of controlData.options;let i =index' class="options">
        <form [formGroup]='form'>
            <mat-list-item>
                <div class="row">
                    <div class="col-lg-2 padding-top">
                        <button mat-icon-button *ngIf='i > 1' type="button" (click)='removeOption(i)'>
                            <mat-icon color='danger'>delete</mat-icon>
                        </button>
                    </div>
                    <div class="col-lg-10">
                        <mat-form-field>
                            <mat-label>{{'Option#'+(i+1)}} - Name</mat-label>
                            <input autocomplete="off" matInput formControlName="name">
                            <mat-error *ngIf="form.controls.name.errors">
                                {{'Option#'+(i+1)}} - (<i>Name</i>) is <strong>required</strong>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </mat-list-item>
            <mat-list-item>
                <div class="row">
                    <div class="col-lg-2 padding-top">

                    </div>
                    <div class="col-lg-10">
                        <mat-form-field>
                            <mat-label>{{'Option#'+(i+1)}} - Value</mat-label>
                            <input autocomplete="off" matInput formControlName="value">
                            <mat-error *ngIf="form.controls.name.errors">
                                {{'Option#'+(i+1)}} - (<i>Value</i>) is <strong>required</strong>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </mat-list-item>
        </form>
        <hr *ngIf='i != controlData.options.length - 1'>
    </ng-container>
</mat-list>